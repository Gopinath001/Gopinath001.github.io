<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><meta name=author content=Bluepie><link rel=prev href=//bluepie.in/2019/05/modsecurity/><link rel=next href=//bluepie.in/2019/07/android-reversing/><link rel=canonical href=//bluepie.in/2019/06/google-ctf-2019/><link rel=apple-touch-icon sizes=180x180 href=//bluepie.in/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=//bluepie.in/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=//bluepie.in/favicon-16x16.png><link rel=manifest href=//bluepie.in/site.webmanifest><link rel=mask-icon href=//bluepie.in/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>Google Ctf 2019 | Bluepie&#39;s update blog</title><meta name=title content="Google Ctf 2019 | Bluepie's update blog"><link rel=stylesheet href=//bluepie.in/font/iconfont.css><link rel=stylesheet href=//bluepie.in/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"\/\/bluepie.in\/"},"articleSection":"posts","name":"Google Ctf 2019","headline":"Google Ctf 2019","description":"hey!. future me,(addressing myself) Status Update:So its been almost a year since i joined a company and having my career growing, but my personal goals are just at the same position when i left my student life. Gosh wish things where different, So another long time since i made my last post. time really flies by, so the most part im ok i guess with inner conflicts, mental forgetfullness, slow motion, slow thinking.","inLanguage":"en-us","author":"Bluepie","creator":"Bluepie","publisher":"Bluepie","accountablePerson":"Bluepie","copyrightHolder":"Bluepie","copyrightYear":"2019","datePublished":"2019-06-29 18:35:30 \x2b0530 IST","dateModified":"2019-06-29 18:35:30 \x2b0530 IST","url":"\/\/bluepie.in\/2019\/06\/google-ctf-2019\/","wordCount":"1549","keywords":["Bluepie\x27s update blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-student-alt"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s update blog</a></div><div class="menu navbar-right"><a class=menu-item href=//bluepie.in/posts/>Blog</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s update blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=//bluepie.in/posts/>Blog</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-135013873-2','auto');ga('send','pageview');}</script><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Google Ctf 2019</h1><div class=post-meta>Written by <a itemprop=name href=//bluepie.in/ rel=author>Bluepie</a> with â™¥
<span class=post-time>on <time datetime=2019-06-29 itemprop=datePublished>June 29, 2019</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=//bluepie.in/categories/tech/>Tech</a>
<a href=//bluepie.in/categories/networking/>Networking</a>
<a href=//bluepie.in/categories/security/>Security</a>
<a href=//bluepie.in/categories/ctf/>CTF</a></span></div></header><div class=post-content><img src=//bluepie.in/images/posts/googleCTF.png class=featured_image><blockquote><p>hey!. future me,(addressing myself)
<strong><em>Status Update:So its been almost a year since i joined a company and having my career growing, but my personal goals are just at the same position when i left my student life. Gosh wish things where different, So another long time since i made my last post. time really flies by, so the most part im ok i guess with inner conflicts, mental forgetfullness, slow motion, slow thinking. For the past some weeks everything around me feels like it has been sped up, but i am still moving slowly.</em></strong></p></blockquote><hr><h2 id=thing-that-got-me-interested-google-capture-the-flag>Thing that got me interested - Google Capture the flag.</h2><p>As i said, i haven&rsquo;t given up all my hobbies, recently i was eager to participate in the capture the flag conducted by google, because i was free during that time cuz that was on a saturday and sunday, (not office hours,). So this post will cover that, i wont be writing everything, since this is ultimately for the sake of me that i am doing this.</p><h3 id=challenges>challenges</h3><p>Im going to be vague about most of the things, except the ones i felt where challenging and interesitng to me.
so the first challenge was a binary challenge, that was pretty easy a 30 second view and string analysis of the file gave me the flag, &ldquo;CTF{welcome_to_googlectf}&rdquo; it was the beginning after all.</p><p>the next part was also a binay involved, but that binary was connecting to the internet to communicat, wireshark can be used for instance but using wireshark for this beginner task is an overkill, what i did was found out the server ip from the binary, connected to the server directly, got the flag, bypassing the protection from the binary,</p><p>the next part is a two parter, first you have to find the ip address of the server, then after connecting to the server, you have limited access, you do not have any permission what so ever, the flag is there in a file with no permission set to it, but you can access &ldquo;bin/&rdquo; directory with exec permissions to some of the executables, but no exec permissions to busybox binary, with some tweaking and wandering around this round is also simple.</p><p>the next round you are presented boot sector ntfs file. the file contains the details to the flag apparently, so we mount the ntfs file, find all the files that are likely to be the flag, apparently all the files are empty with 0 bytes,by filtering the files which are above 1kb, the results shows up as only one, we get a hint that the flag is stored in pic directory on the file&rsquo;s extra attribute section.</p><p>the next level was an xss injection, that is pretty easy i guess, basically you have to get the admin&rsquo;s cookies and session id to get the flag.</p><p>some of the challenges are very easy so I am not going to cover them, if you know basic reverse engineering and cyber security, you could solve them easily.</p><p><strong><em>a challenge that was fresh and I have not seen anything like that challenge before, I am going to write about how I managed to solve that.</em></strong></p><hr><h3 id=a-challenge-that-was-interesting-to-me>A challenge that was interesting to me.</h3><p>so here comes the big thing that took me a lot of time to figure this out, It was a reversing challenge, it consisted of a python program with a file as argument to it, the argument file consist of emojis, python program emulates stack based vm with the smiles as instructions, Im gona walk through how i was able to solve this problem.</p><p>The source of the program was given, it was just a python program, but it was quite hard to understand what they where doing at first, the link to the files are below, check them out, you have to run them on python3.</p><p><a href=//bluepie.in/attachments/vmbackup.py title="python Source code">vmbackup.py</a></p><p><a href=//bluepie.in/attachments/program title="python Source code">program</a></p><h4 id=the-problem-with-this>the problem with this?.</h4><p>So pretty much it prints a url, letter by letter, but gradually it slows down and at some point it stops, so the algorithm they are using might be the issue here, so when opening the program file you will find smiles inside of it, and the python program uses those smiles one by one as instrcutions and runs them. just like a modern cpu running the binary file. i was twisting my head around replacing smilies to understand the program, i could idenify pattersn but nothing more.</p><p>A little later I tried a different approach, which is print statements, the python progrm is still python right, so made some print statements in different places, then ran the program.</p><h5 id=where-i-made-the-comments>where I made the comments.</h5><pre><code class=language-python>
  def xor(self):
    a = self.stack.pop()
    b = self.stack.pop()
    print(&quot; xor:: a:&quot; + str(a) +&quot; b:&quot;+ str(b) +&quot;\n&quot;)
    self.stack.append(b ^ a)

  def print_top(self):
    print(self.stack);
    sys.stdout.write(chr(self.stack.pop()))
    sys.stdout.flush()

  def push(self):
    if self.rom[self.instruction_pointer] == 'ðŸ¥‡':
      self.stack.append(self.accumulator1)
      print(&quot;accumulator1 :&quot; + str(self.accumulator1) )
    elif self.rom[self.instruction_pointer] == 'ðŸ¥ˆ':
      self.stack.append(self.accumulator2)
      print(&quot;accumulator2 :&quot; + str(self.accumulator1) )
    else:
      raise RuntimeError('Unknown instruction {} at position {}'.format(
          self.rom[self.instruction_pointer], str(self.instruction_pointer)))
    self.instruction_pointer += 1

    def load(self):
    num = 0

    if self.rom[self.instruction_pointer] == 'ðŸ¥‡':
      acc = 1
    elif self.rom[self.instruction_pointer] == 'ðŸ¥ˆ':
      acc = 2
    else:
      raise RuntimeError('Unknown instruction {} at position {}'.format(
          self.rom[self.instruction_pointer], str(self.instruction_pointer)))
    self.instruction_pointer += 1

    while self.rom[self.instruction_pointer] != 'âœ‹':
      num = num * 10 + (ord(self.rom[self.instruction_pointer][0]) - ord('0'))
      print(&quot;rom: &quot;+str(ord(self.rom[self.instruction_pointer][0])) +&quot; ord:&quot;+ str((ord(self.rom[self.instruction_pointer][0]) - ord('0')) ))
      self.instruction_pointer += 1

    if acc == 1:
      self.accumulator1 = num
    else:
      self.accumulator2 = num

    self.instruction_pointer += 1

</code></pre><p>After making the comments things were much clearer to me, all the comments that I made in the above program I didn&rsquo;t do it in one instance and run the program, I made some comments in the program run at and check the weather it make sense and added some more comments and then run it again and again&hellip; I have also attached the log files which was generated from the different runs.</p><p><a href=//bluepie.in/attachments/output.txt title=run#1>output.txt</a></p><p><a href=//bluepie.in/attachments/outputWithXor.txt title=run#2>outputWithXor.txt</a></p><p><a href=//bluepie.in/attachments/outputWithXorWithAccumulator.txt title=run#3>outputWithXorWithAccumulator.txt</a></p><p><a href=//bluepie.in/attachments/outputWithXorWithRom.txt title=run#4>outputWithXorWithRom.txt</a></p><hr><h4 id=solving-thought-process>solving thought process</h4><p>Download and check the different log files from above, analysing each of those health individually will give you an idea, well it give me an idea, all the different mechanics in the program were making sense to me now, the accumulator 1, accumulator 2, push instructions, pop instructions, load instructions&hellip;</p><p>You see when the program first runs, it just load the bunch of numbers into the memory after that it performs mathematical operations to find prime numbers, on the moment it finds a prime number it performs an <strong><em>XOR operation on a number that was initially loaded(a number that is in the top of the stack)</em></strong> this produces an integer value, this integer value corresponds to an ASCII character.. yeah! integer values are converted to ASCII character and then print out. This is the basis of the URL generator.</p><p>So we have the encoded URL as numbers in memory, you can easily find this out in the log files that I have attach, so we can easily extract those numbers, find the prime numbers ourselves and then perform xor operation and get the URL, easy right? .</p><p>So I cooked a a Python program that finds a series of prime numbers and then performs XOR operation. Running that I couldn&rsquo;t find the URL it was printing random rubbish things. After inspecting closely I found out that the prime numbers or not in a series, are they were using some logic or or some other thing and only using certain prime numbers. This was the part where I was stuck and couldn&rsquo;t get my brain around this. I was literally stuck for 45 minutes and clearly missed out the clue that was in front of me, maybe my office activities made my brain dull.</p><p>I found out that the <strong><em>prime numbers are in-fact in series, but the series contained only prime numbers that where palindromic</em></strong>. So I did some tweaks to my program and then executed it. Vola! I got the URL in an instant, with that URL I solved that challenge.</p><h4 id=solution>solution.</h4><pre><code class=language-python>
# Make sure to run the program in Python 3, I cooked up this program quickly so forgive my bad code,

import operator
toDecode = [17488, 16758, 16599, 16285, 16094, 15505, 15417, 14832, 14450, 13893, 13926, 13437, 12833, 12741, 12533, 11504, 11342, 10503, 10550, 10319, 975, 1007, 892, 893, 660, 743, 267, 344, 264, 339, 208, 216, 242, 172, 74, 49, 119, 113, 119,106]

def checkprime(num):
	flag=True
	for x in range(3,(int(num/2))+1):
		if(num%x==0):
			flag=False
	return flag


def primeNumberGenerator():
	primeNumberArr = [2,3,5,7]
	for x in range(10,17488):
		if(checkprime(x)):
			primeNumberArr.append(x)
	return primeNumberArr

def filterPalindromeFromPrime(primeNumberArr):
	primePalindrome = []
	for x in primeNumberArr:
		if (str(x) == str(x)[::-1]):
			primePalindrome.append(x)
	return primePalindrome

def decode(PrimePalindromeArr):
	toDecode.reverse()
	url = []
	print(&quot;toDecode Count:&quot; +str(len(toDecode)))
	print(&quot;PrimePalindromeArr Count:&quot; +str(len(PrimePalindromeArr)))
	for index, value in enumerate(toDecode):
		character = operator.xor(PrimePalindromeArr[index],value)
		print(&quot;palindromeValue:&quot;+str(PrimePalindromeArr[index]))
		print(&quot;value:&quot;+str(value))
		print(&quot;character:&quot;+chr(character))
		url.append(chr(character))

	print(&quot;url:&quot;+&quot;&quot;.join(url))



if __name__ == '__main__':
	primeArr = primeNumberGenerator()
	PrimePalindromeArr = filterPalindromeFromPrime(primeArr)
	decode(PrimePalindromeArr)

# Also forgot to mention there where three batches of toDecode, join them entirely to get the complete URL

</code></pre><blockquote><p><strong><em>I did manage to solve the challenges, but for the sake of this post I am gonna keep this short, already the post is very huge and it took me so long to write this. I know I am a bad typer(could not type very fast). I promise you that I will post all the challenges that were challenging to me. Bye See ya soon.</em></strong></p></blockquote></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Bluepie</span></p><p class=copyright-item><span>Link:</span>
<a href=//bluepie.in/2019/06/google-ctf-2019/>//bluepie.in/2019/06/google-ctf-2019/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> Â·
<span><a href=//bluepie.in/>home</a></span></section></div><div class=post-nav><a href=//bluepie.in/2019/05/modsecurity/ class=prev rel=prev title=ModSecurity><i class="iconfont icon-left"></i>&nbsp;ModSecurity</a>
<a href=//bluepie.in/2019/07/android-reversing/ class=next rel=next title="Android Reversing">Android Reversing&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"gopinath001-github-io-blog"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2017 - 2019</span>
<span class=with-love>|</span>
<span class=author itemprop=copyrightHolder><a href=//bluepie.in/>Bluepie</a></span></div></footer><script src=//bluepie.in/js/vendor_no_gallery.min.js async></script></div></body></html>