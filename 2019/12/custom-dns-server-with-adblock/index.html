<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><meta name=author content=Bluepie><link rel=prev href=//bluepie.in/2019/12/linux-ld_preload/><link rel=next href=//bluepie.in/2020/01/noises-or-im-wrong/><link rel=canonical href=//bluepie.in/2019/12/custom-dns-server-with-adblock/><link rel=apple-touch-icon sizes=180x180 href=//bluepie.in/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=//bluepie.in/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=//bluepie.in/favicon-16x16.png><link rel=manifest href=//bluepie.in/site.webmanifest><link rel=mask-icon href=//bluepie.in/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>Custom Dns Server With Adblock | Bluepie&#39;s update blog</title><meta name=title content="Custom Dns Server With Adblock | Bluepie's update blog"><link rel=stylesheet href=//bluepie.in/font/iconfont.css><link rel=stylesheet href=//bluepie.in/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"\/\/bluepie.in\/"},"articleSection":"posts","name":"Custom Dns Server With Adblock","headline":"Custom Dns Server With Adblock","description":"hello guys, as of writing this post this is christmas of 2019 (25 dec 2019), gosh time really goes fast!. How was the holidays? personal update: I have sevre cold \x26amp; fever as of writing this, hope i\x26rsquo;ll get better soon.\n Today im going to share my method of adblocking with custom dns servers my requiremets  I want adblocking solution without any addons \x26amp; applications for laptops\/desktops\/mobile.","inLanguage":"en-us","author":"Bluepie","creator":"Bluepie","publisher":"Bluepie","accountablePerson":"Bluepie","copyrightHolder":"Bluepie","copyrightYear":"2019","datePublished":"2019-12-25 14:15:33 \x2b0530 IST","dateModified":"2019-12-25 14:15:33 \x2b0530 IST","url":"\/\/bluepie.in\/2019\/12\/custom-dns-server-with-adblock\/","wordCount":"1455","keywords":["Bluepie\x27s update blog"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-student-alt"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s update blog</a></div><div class="menu navbar-right"><a class=menu-item href=//bluepie.in/posts/>Blog</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s update blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=//bluepie.in/posts/>Blog</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-135013873-2','auto');ga('send','pageview');}</script><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Custom Dns Server With Adblock</h1><div class=post-meta>Written by <a itemprop=name href=//bluepie.in/ rel=author>Bluepie</a> with ♥
<span class=post-time>on <time datetime=2019-12-25 itemprop=datePublished>December 25, 2019</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=//bluepie.in/categories/teach/>Teach</a>
<a href=//bluepie.in/categories/server/>Server</a>
<a href=//bluepie.in/categories/dns/>DNS</a>
<a href=//bluepie.in/categories/adblock/>adblock</a></span></div></header><div class=post-content><img src=//bluepie.in/images/posts/grimd-custom-dns-proxy.png class=featured_image><blockquote><p>hello guys, as of writing this post this is christmas of 2019 (25 dec 2019), gosh time really goes fast!. How was the holidays? personal update: I have sevre cold &amp; fever as of writing this, hope i&rsquo;ll get better soon.</p></blockquote><hr><h2 id=today-im-going-to-share-my-method-of-adblocking-with-custom-dns-servers>Today im going to share my method of adblocking with custom dns servers</h2><h3 id=my-requiremets>my requiremets</h3><ul><li>I want adblocking solution without any addons &amp; applications for laptops/desktops/mobile.</li><li>I want it universal (meaning it has to work outside of my home network)</li><li>I should not waste time setting it up (should be quick and simple to setup)</li><li>should be configurable (easy to configure)</li><li>should work perfectly &amp; should not cost me anything</li></ul><h3 id=explanation>explanation</h3><p>Sound pretty simple ain&rsquo;t it? we&rsquo;ll it ain&rsquo;t easy to do.</p><h4 id=crossplatform-laptop-mobile-anydevice-that-has-access-to-internet>crossplatform (laptop/mobile/..anydevice that has access to internet)</h4><p>This requirement rules out addons, applications on all devices.</p><h4 id=work-outside-of-my-home-network>work outside of my home network)</h4><p>This requirement rules out private adblocking solutions, so a server is need for this, luckly, I have server on aws,
<em>but that server is already being used for a different purpose, so it has to be minimal impact on the cpu and memory</em></p><p>obvious anwser would be to use pi-hole <a href="work outside of my home network" rel="nofollow noreferrer" target=_blank>pie-hole</a>), my experience with pie-hole is not good, let me explain what i mean by that, I had problems trying to install it(the automated script did not work for me), it took me so much time to debug the error, second is it had a extra bit of cpu load compared to my other options.</p><h4 id=should-be-quick-and-simple-to-setup>should be quick and simple to setup)</h4><p>I should not waste time learning a new tool,(don&rsquo;t a industrial level dns server, I just need a simple solution), plus if any error, it should be easy for me to debug.</p><h4 id=configurable-easy-to-configure>configurable (easy to configure)</h4><p>some things i looked for, should be
* able to mention, forward dns vendor (google/opendns)
* easy to install
* easy to add adblocking lists (just add files from differnet adblock sources)
* easy to add whitelists
* i should have a log, to inspect if anything is not working</p><h4 id=should-not-cost-me-anything>should not cost me anything</h4><p>This makes the solution to be open source, I already have a server that i am paying for so i&rsquo;ll just add this to it, So there is no additional cost.</p><h3 id=hidden-gem-the-solution>Hidden gem - The solution</h3><p>So after trying several solutions(trust me i wasted a lot of time, installing &amp; uninstalling) I arrived at <a href=https://github.com/looterz/grimd rel="nofollow noreferrer" target=_blank>grimd</a>, an opensource project written in go. It had all the capabilities that I mentioned above(checkout the grimd&rsquo;s page), It even comes in prebuilt binaries, So i do not even have to compile anything.</p><h3 id=installing-it-to-myserver>Installing it to myserver</h3><ul><li>download the binary from the release page</li><li>run it on the server</li><li>open port 51 (udp &amp; tcp) on firewall inside cloud instance &amp; vendor firewall</li><li>add my custom adblock list to the config file (grimd.toml)</li><li>change default nameserver to google dns in config file</li><li>change the dns server on my laptops &amp; mobiles, that is it.</li></ul><p>that is it, that is all i have to do, here is the log where it is in action</p><pre><code class=language-bash>
20:29:01.341 DEBU handler.go:252 ▶ 103c insert d.joinhoney.com IN A into cache with ttl 140
20:29:11.361 INFO handler.go:102 ▶ 103d 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:29:11.361 DEBU cache.go:208 ▶ 103e KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:29:11.361 DEBU cache.go:123 ▶ 103f Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:29:11.361 DEBU cache.go:133 ▶ 1040 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:29:11.361 DEBU handler.go:124 ▶ 1041 vortex.data.microsoft.com IN AAAA didn't hit cache
20:29:11.361 NOTI handler.go:180 ▶ 1042 vortex.data.microsoft.com found in blocklist
20:29:11.362 INFO handler.go:102 ▶ 1043 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:29:11.362 DEBU cache.go:208 ▶ 1044 KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:29:11.362 DEBU cache.go:123 ▶ 1045 Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:29:11.362 DEBU cache.go:133 ▶ 1046 Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:29:11.362 DEBU handler.go:124 ▶ 1047 vortex.data.microsoft.com IN A didn't hit cache
20:29:11.362 NOTI handler.go:180 ▶ 1048 vortex.data.microsoft.com found in blocklist
20:29:30.496 INFO handler.go:102 ▶ 1049 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:29:30.496 DEBU cache.go:208 ▶ 104a KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:29:30.496 DEBU cache.go:123 ▶ 104b Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:29:30.496 DEBU cache.go:133 ▶ 104c Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:29:30.496 DEBU handler.go:124 ▶ 104d vortex.data.microsoft.com IN A didn't hit cache
20:29:30.497 NOTI handler.go:180 ▶ 104e vortex.data.microsoft.com found in blocklist
20:29:30.497 INFO handler.go:102 ▶ 104f 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:29:30.497 DEBU cache.go:208 ▶ 1050 KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:29:30.497 DEBU cache.go:123 ▶ 1051 Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:29:30.497 DEBU cache.go:133 ▶ 1052 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:29:30.497 DEBU handler.go:124 ▶ 1053 vortex.data.microsoft.com IN AAAA didn't hit cache
20:29:30.497 NOTI handler.go:180 ▶ 1054 vortex.data.microsoft.com found in blocklist
20:29:45.932 INFO handler.go:102 ▶ 1055 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:29:45.932 DEBU cache.go:208 ▶ 1056 KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:29:45.932 DEBU cache.go:123 ▶ 1057 Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:29:45.932 DEBU cache.go:133 ▶ 1058 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:29:45.932 DEBU handler.go:124 ▶ 1059 vortex.data.microsoft.com IN AAAA didn't hit cache
20:29:45.932 NOTI handler.go:180 ▶ 105a vortex.data.microsoft.com found in blocklist
20:29:45.932 INFO handler.go:102 ▶ 105b 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:29:45.932 DEBU cache.go:208 ▶ 105c KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:29:45.932 DEBU cache.go:123 ▶ 105d Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:29:45.932 DEBU cache.go:133 ▶ 105e Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:29:45.932 DEBU handler.go:124 ▶ 105f vortex.data.microsoft.com IN A didn't hit cache
20:29:45.933 NOTI handler.go:180 ▶ 1060 vortex.data.microsoft.com found in blocklist
20:30:00.976 INFO handler.go:102 ▶ 1061 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:30:00.976 DEBU cache.go:208 ▶ 1062 KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:30:00.977 DEBU cache.go:123 ▶ 1063 Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:30:00.977 DEBU cache.go:133 ▶ 1064 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:30:00.977 DEBU handler.go:124 ▶ 1065 vortex.data.microsoft.com IN AAAA didn't hit cache
20:30:00.977 NOTI handler.go:180 ▶ 1066 vortex.data.microsoft.com found in blocklist
20:30:00.977 INFO handler.go:102 ▶ 1067 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:30:00.977 DEBU cache.go:208 ▶ 1068 KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:30:00.977 DEBU cache.go:123 ▶ 1069 Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:30:00.977 DEBU cache.go:133 ▶ 106a Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:30:00.977 DEBU handler.go:124 ▶ 106b vortex.data.microsoft.com IN A didn't hit cache
20:30:00.977 NOTI handler.go:180 ▶ 106c vortex.data.microsoft.com found in blocklist
20:30:16.972 INFO handler.go:102 ▶ 106d 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:30:16.973 DEBU cache.go:208 ▶ 106e KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:30:16.973 DEBU cache.go:123 ▶ 106f Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:30:16.973 DEBU cache.go:133 ▶ 1070 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:30:16.973 DEBU handler.go:124 ▶ 1071 vortex.data.microsoft.com IN AAAA didn't hit cache
20:30:16.973 NOTI handler.go:180 ▶ 1072 vortex.data.microsoft.com found in blocklist
20:30:16.973 INFO handler.go:102 ▶ 1073 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:30:16.973 DEBU cache.go:208 ▶ 1074 KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:30:16.973 DEBU cache.go:123 ▶ 1075 Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:30:16.973 DEBU cache.go:133 ▶ 1076 Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:30:16.973 DEBU handler.go:124 ▶ 1077 vortex.data.microsoft.com IN A didn't hit cache
20:30:16.973 NOTI handler.go:180 ▶ 1078 vortex.data.microsoft.com found in blocklist
20:30:33.009 INFO handler.go:102 ▶ 1079 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:30:33.010 DEBU cache.go:208 ▶ 107a KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:30:33.010 DEBU cache.go:123 ▶ 107b Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:30:33.010 DEBU cache.go:133 ▶ 107c Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:30:33.010 DEBU handler.go:124 ▶ 107d vortex.data.microsoft.com IN AAAA didn't hit cache
20:30:33.010 NOTI handler.go:180 ▶ 107e vortex.data.microsoft.com found in blocklist
20:30:33.010 INFO handler.go:102 ▶ 107f 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:30:33.010 DEBU cache.go:208 ▶ 1080 KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:30:33.010 DEBU cache.go:123 ▶ 1081 Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:30:33.010 DEBU cache.go:133 ▶ 1082 Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:30:33.010 DEBU handler.go:124 ▶ 1083 vortex.data.microsoft.com IN A didn't hit cache
20:30:33.010 NOTI handler.go:180 ▶ 1084 vortex.data.microsoft.com found in blocklist
20:30:48.234 INFO handler.go:102 ▶ 1085 219.91.177.2 lookup　vortex.data.microsoft.com IN AAAA
20:30:48.235 DEBU cache.go:208 ▶ 1086 KeyGen: vortex.data.microsoft.com IN AAAA 6210738ab9fea7763f2ba8ec16beb2c3
20:30:48.235 DEBU cache.go:123 ▶ 1087 Cache: Key expired 6210738ab9fea7763f2ba8ec16beb2c3
20:30:48.235 DEBU cache.go:133 ▶ 1088 Cache: Cannot find key 6210738ab9fea7763f2ba8ec16beb2c3
20:30:48.235 DEBU handler.go:124 ▶ 1089 vortex.data.microsoft.com IN AAAA didn't hit cache
20:30:48.235 NOTI handler.go:180 ▶ 108a vortex.data.microsoft.com found in blocklist
20:30:48.235 INFO handler.go:102 ▶ 108b 219.91.177.2 lookup　vortex.data.microsoft.com IN A
20:30:48.235 DEBU cache.go:208 ▶ 108c KeyGen: vortex.data.microsoft.com IN A 87ca3e2c1cf9d028f97ce6794f963327
20:30:48.235 DEBU cache.go:123 ▶ 108d Cache: Key expired 87ca3e2c1cf9d028f97ce6794f963327
20:30:48.235 DEBU cache.go:133 ▶ 108e Cache: Cannot find key 87ca3e2c1cf9d028f97ce6794f963327
20:30:48.235 DEBU handler.go:124 ▶ 108f vortex.data.microsoft.com IN A didn't hit cache
20:30:48.235 NOTI handler.go:180 ▶ 1090 vortex.data.microsoft.com found in blocklist
20:31:00.797 INFO handler.go:102 ▶ 1091 219.91.177.2 lookup　dev.bluepie.in IN AAAA
20:31:00.798 DEBU cache.go:208 ▶ 1092 KeyGen: dev.bluepie.in IN AAAA e424b1464ef59d6aff7514f252c6b088
20:31:00.798 DEBU cache.go:133 ▶ 1093 Cache: Cannot find key e424b1464ef59d6aff7514f252c6b088
20:31:00.798 DEBU cache.go:133 ▶ 1094 Cache: Cannot find key e424b1464ef59d6aff7514f252c6b088

</code></pre><h3 id=you-might-argue-that-this-is-not-a-dns-server-it-is-a-proxy-server-for-dns-well-it-depends-up-how-you-see-it>&gt; You might argue that, this is not a dns server, it is a proxy server for dns. Well it depends up how you see it</h3><h2 id=conclusion>conclusion</h2><p>From my experience, its simple, awsome &amp; works great, No ads system wide! on all networks! on all devices!,
My very own private dns server..XD.If you have any doubts, just dm me!</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Bluepie</span></p><p class=copyright-item><span>Link:</span>
<a href=//bluepie.in/2019/12/custom-dns-server-with-adblock/>//bluepie.in/2019/12/custom-dns-server-with-adblock/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> ·
<span><a href=//bluepie.in/>home</a></span></section></div><div class=post-nav><a href=//bluepie.in/2019/12/linux-ld_preload/ class=prev rel=prev title="Liunx LD_PRELOAD"><i class="iconfont icon-left"></i>&nbsp;Liunx LD_PRELOAD</a>
<a href=//bluepie.in/2020/01/noises-or-im-wrong/ class=next rel=next title="Noises or Im Wrong">Noises or Im Wrong&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"gopinath001-github-io-blog"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2017 - 2020</span>
<span class=with-love>|</span>
<span class=author itemprop=copyrightHolder><a href=//bluepie.in/>Bluepie</a></span></div></footer><script src=//bluepie.in/js/vendor_no_gallery.min.js async></script></div></body></html>