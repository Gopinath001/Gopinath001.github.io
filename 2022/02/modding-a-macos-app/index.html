<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><meta name=author content=Bluepie><meta name=description content="Public Journal of aghontpi"><meta name=keywords content="aghontpi bluepie Journal"><link rel=prev href=//bluepie.in/2022/01/publishing-to-fdroid-google-play/><link rel=next href=//bluepie.in/2023/01/updating-dns-servers-for-ads-and-tracking-protection-in-2023/><link rel=canonical href=//bluepie.in/2022/02/modding-a-macos-app/><link rel=apple-touch-icon sizes=180x180 href=//bluepie.in/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=//bluepie.in/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=//bluepie.in/favicon-16x16.png><link rel=manifest href=//bluepie.in/site.webmanifest><link rel=mask-icon href=//bluepie.in/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>Modding a macOS App | Bluepie&#39;s Journal</title><meta name=title content="Modding a macOS App | Bluepie's Journal"><link rel=stylesheet href=//bluepie.in/font/iconfont.css><link rel=stylesheet href=//bluepie.in/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"\/\/bluepie.in\/"},"articleSection":"posts","name":"Modding a macOS App","headline":"Modding a macOS App","description":"Intro This post is about reversing.. but for a MACOS binary. Lets drive straight into it.\nModding in macOS is fairly new to me, but a binary is a binary and it can be modded!. I started to daily drive macOS a month or two ago, the why and what\x26rsquo;s is a whole different story to post about.\nLike I have said previously in my other re posts, \x26ldquo; I don\x26rsquo;t trust mods from the internet\x26rdquo; If I can mod it then its fine, otherwise I\x26rsquo;m paying for it.","inLanguage":"en-us","author":"Bluepie","creator":"Bluepie","publisher":"Bluepie","accountablePerson":"Bluepie","copyrightHolder":"Bluepie","copyrightYear":"2022","datePublished":"2022-02-20 19:10:13 \x2b0000 UTC","dateModified":"2022-02-20 19:10:13 \x2b0000 UTC","url":"\/\/bluepie.in\/2022\/02\/modding-a-macos-app\/","wordCount":"781","keywords":["Bluepie\x27s Journal"]}</script><script type=text/javascript>(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script","9oioq6tja4");</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="extra extra-moon"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s Journal</a></div><div class="menu navbar-right"><a class=menu-item href=//bluepie.in/posts/>My Journal</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="extra extra-moon"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s Journal</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=//bluepie.in/posts/>My Journal</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-135013873-2','auto');ga('send','pageview');}</script><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Modding a macOS App</h1><div class=post-meta>Written by <a itemprop=name href=//bluepie.in/ rel=author>Bluepie</a> with â™¥
<span class=post-time>on <time datetime=2022-02-20 itemprop=datePublished>February 20, 2022</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=//bluepie.in/categories/tech/>Tech</a>
<a href=//bluepie.in/categories/reversing/>Reversing</a>
<a href=//bluepie.in/categories/macos/>Macos</a>
<a href=//bluepie.in/categories/teach/>Teach</a></span></div></header><div class=post-content><img src=//bluepie.in/images/posts/modding-a-macos-app/feb-2022.png class=featured_image><h2 id=intro>Intro</h2><p>This post is about reversing.. but for a MACOS binary. Lets drive straight into it.</p><p>Modding in macOS is fairly new to me, but a binary is a binary and it can be modded!. I started to daily drive macOS a month or two ago, the why and what&rsquo;s is a whole different story to post about.</p><p>Like I have said previously in my other <a href=https://bluepie.in/categories/reversing/ rel="nofollow noreferrer" target=_blank>re posts</a>, &ldquo; I don&rsquo;t trust mods from the internet&rdquo; If I can mod it then its fine, otherwise I&rsquo;m paying for it.</p><p>I just started to understand the quirks of &ldquo;OS X&rdquo;, Though some of my methods may be crude&hellip;it works, I will perfect them..</p><h2 id=target>Target</h2><p>So there is this great app for cleaning your Mac&rsquo;s junk/storage files, but the free version only lets you clean 500mb daily.. the premium version is a whooping 3k per year&hellip;do you get where I am going with this ? &hellip;YES!&hellip;modding for fun and profit (PROFIT = personal use)</p><h2 id=tools>Tools</h2><p>So I&rsquo;m gonna be trying out ghidra &ldquo; The NSA&rsquo;s reverse engineering tool &ldquo;, mainly because Its a open source tool and I wanted to do some reverse engineering with it for a long time now.</p><p>make sure you have <a href=https://brew.sh/ rel="nofollow noreferrer" target=_blank>brew</a> installed and then run the following command</p><pre><code class=language-console>brew install --cask ghidra
</code></pre><h2 id=making-observation-to-the-target>Making observation to the target</h2><p>The app throws you with the &ldquo;Nag Screen&rdquo; whenever you use the app, it blocks the usage of features (can not use the app to remove more than 500MB of data,privacy scanning won&rsquo;t work unless you pay,..etc).</p><ul><li>500mb storage limit reached &lsquo;nag screen&rsquo;</li></ul><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/500mb-over-nag-screen.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><ul><li>Trial period expired &lsquo;nag screen&rsquo;</li></ul><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/clean-my-mac-unmodded.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><h2 id=basics-understanding-ghidra>Basics &amp; Understanding Ghidra</h2><p>All macOS apps have the following structure, the main binary will always be inside the MacOS directory.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/mac-app-folder-structure.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>Launch Ghidra and create a new project, then drag and drop the binary into the project.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/create-new-project.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>Mac has this binary format &ldquo;macobinary&rdquo; - basically it contains the different target executables, ex: (arm binary vs the x86 binary).. mine is a x86 machine, will be modding that alone.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/choose-appropriate-target-binary.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>After the import, Ghidra will automatically ask you to analyse the target binary, choose Analyse. (it will make our life easier), based on the binary size and your cpu cores, it may take couple minutes.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/will-ask-for-analyse-choose-analyse.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>Only focus on the following five windows, that is enough to get the job done.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/ghidra-ui.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><ul><li>1 = will contain the symbol tabel, this is where we do most of the filtering.</li><li>2 = shows the disassembly of the binary (assembly language), this is where we do the actual reversing, (i.e) patching, understanding logic, etc.</li><li>3 = This is a great feature, shows the equivalent c code, to the selected assembly section.</li><li>4 &amp; 5 = shows the incoming and outgoing function calls, this will help us find interesting things about the binary, which then can be used for identifying logic and patching.</li></ul><p>IF ANY OF THE ABOVE WINDOWS ARE NOT OPEN, YOU CAN ENABLE THEM THROUGH THE MENU OPTION &ldquo;WINDOW&rdquo;.</p><h2 id=analysis>Analysis</h2><p>It will take some time to find what you are looking for, but I have already invested time in this, so what we need is &ldquo;activationManager&rdquo; class, it has all sorts of interesting functions like &ldquo;activationStatus, isAppActivated..etc&rdquo;. Looking for references, it is used throughout the app, so lets change it.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/different-app-status.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>Looking around, we find the different status codes inside &ldquo;activationStatus&rdquo;.</p><p>By checking other functions, it becomes obvious that, changing only &ldquo;isAppActivated&rdquo; function is enough. The return type of the function is &ldquo;char&rdquo;, with reference to &ldquo;status&rdquo; from above..we should return &ldquo;3&rdquo;. From the ascii table, &ldquo;0x33&rdquo; is the equivalnet for &ldquo;3&rdquo;.</p><p>Patching the &ldquo;isAppActivated&rdquo; function, with the following code.</p><pre><code class=language-shell>push   rbp
mov    rbp,rsp
mov    DWORD PTR [rbp-0x4],0x0
mov    eax,0x33
pop    rbp
ret
</code></pre><p>then export the program &ldquo;File -&gt; Export Program&rdquo;, our patched binary is ready. Now give executable permission and move it to the original directory.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/move-exported-binary-to-original-directory.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>rename the original</p><h2 id=signing-running-the-modded-binary-for-profit>Signing &amp; Running the modded binary for PROFIT</h2><p>Unlike windows and linux, macOS won&rsquo;t run applications without signing the binary.. but we can generate your own certificates for personal use (dont have to buy a developer account for 99$/year).</p><p>create a certificate using &ldquo;keychain Access&rdquo;</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/create-custom-certifcate.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>choose &ldquo;code signing&rdquo; in &ldquo;certificate type&rdquo;</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/choose-code-signing.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>Go to the application root &ldquo;/Application/&rdquo; to resign the entire app.</p><pre><code class=language-shell>sudo codesign -s &quot;&lt;name-of-certificate&gt;&quot; -fv CleanMyMac-MAS.app/
</code></pre><p>Run the app&hellip; Now its been modded and I don&rsquo;t have to pay 3k INR a year or worry about untrusted binaries from the internet.</p><p><figure><img src=//bluepie.in/images/ring.svg data-sizes=auto data-src=//bluepie.in/images/posts/modding-a-macos-app/removed-files-beyong-the-limit.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><p>You can see from the image, all the premium features are now unlocked &amp; we can also remove the junk files exceeding 500MB.</p><h2 id=end>End</h2><p>This was a fun excerise to dig around. Macos is not that limited as I thought it was&hellip; Sure it has its quirks.</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Bluepie</span></p><p class=copyright-item><span>Link:</span>
<a href=//bluepie.in/2022/02/modding-a-macos-app/>//bluepie.in/2022/02/modding-a-macos-app/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> Â·
<span><a href=//bluepie.in/>home</a></span></section></div><div class=post-nav><a href=//bluepie.in/2022/01/publishing-to-fdroid-google-play/ class=prev rel=prev title='"F-droid" vs the pain that is "Google PlayStore"'><i class="iconfont icon-left"></i>&nbsp;&#34;F-droid&#34; vs the pain that is &#34;Google PlayStore&#34;</a>
<a href=//bluepie.in/2023/01/updating-dns-servers-for-ads-and-tracking-protection-in-2023/ class=next rel=next title="Updating Dns Servers for Ads and Tracking Protection in 2023">Updating Dns Servers for Ads and Tracking Protection in 2023&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"gopinath001-github-io-blog"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2017 - 2023</span>
<span class=with-love>|</span>
<span class=author itemprop=copyrightHolder><a href=//bluepie.in/>Bluepie</a></span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css rel=stylesheet><script src=//bluepie.in/js/vendor_gallery.min.js async></script></div></body></html>