<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><meta name=author content=Bluepie><meta name=description content="Public Journal of aghontpi"><meta name=keywords content="aghontpi bluepie Journal"><link rel=prev href=//bluepie.in/2020/05/android-reversing-part-3/><link rel=next href=//bluepie.in/2020/07/rinku/><link rel=canonical href=//bluepie.in/2020/06/android-reversing-part-4/><link rel=apple-touch-icon sizes=180x180 href=//bluepie.in/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=//bluepie.in/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=//bluepie.in/favicon-16x16.png><link rel=manifest href=//bluepie.in/site.webmanifest><link rel=mask-icon href=//bluepie.in/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>Android Reversing Part 4 | Bluepie&#39;s Journal</title><meta name=title content="Android Reversing Part 4 | Bluepie's Journal"><link rel=stylesheet href=//bluepie.in/font/iconfont.css><link rel=stylesheet href=//bluepie.in/css/main.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"\/\/bluepie.in\/"},"articleSection":"posts","name":"Android Reversing Part 4","headline":"Android Reversing Part 4","description":"Hi me!, how are you doing, how is the future holding up?\nPersonal Update: It\x26rsquo;s been a rough couple weeks since the last post, Covid-19 has shown no rate of slowing down. Nothing been around my mind lately just junk\x26hellip; a lot of junk I don\x26rsquo;t want to think about. To many frequent decisions, Once a friend told me Self control over your thoughts is very important. No matter what I do, It seems I can not achieve it.","inLanguage":"en-us","author":"Bluepie","creator":"Bluepie","publisher":"Bluepie","accountablePerson":"Bluepie","copyrightHolder":"Bluepie","copyrightYear":"2020","datePublished":"2020-06-30 00:21:31 \x2b0530 IST","dateModified":"2020-06-30 00:21:31 \x2b0530 IST","url":"\/\/bluepie.in\/2020\/06\/android-reversing-part-4\/","wordCount":"917","keywords":["Bluepie\x27s Journal"]}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=javascript:void(0); class=theme-switch><i class="extra extra-moon"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s Journal</a></div><div class="menu navbar-right"><a class=menu-item href=//bluepie.in/posts/>My Journal</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="extra extra-moon"></i></a>&nbsp;<a href=//bluepie.in/>Bluepie&#39;s Journal</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=//bluepie.in/posts/>My Journal</a>
<a class=menu-item href=//bluepie.in/categories/>Categories</a></div></div></nav><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-135013873-2','auto');ga('send','pageview');}</script><main class=main><div class=container><article class=post-warp itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline">Android Reversing Part 4</h1><div class=post-meta>Written by <a itemprop=name href=//bluepie.in/ rel=author>Bluepie</a> with â™¥
<span class=post-time>on <time datetime=2020-06-30 itemprop=datePublished>June 30, 2020</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=//bluepie.in/categories/tech/>Tech</a>
<a href=//bluepie.in/categories/reversing/>Reversing</a>
<a href=//bluepie.in/categories/android/>android</a></span></div></header><div class=post-content><img src=//bluepie.in/images/posts/android-reversing-part-4.png class=featured_image><p><em><strong><em>Hi me!, how are you doing, how is the future holding up?</em></strong></em></p><p><em>Personal Update: It&rsquo;s been a rough couple weeks since the last post, Covid-19 has shown no rate of slowing down. Nothing been around my mind lately just junk&hellip; a lot of junk I don&rsquo;t want to think about. To many frequent decisions, Once a friend told me Self control over your thoughts is very important. No matter what I do, It seems I can not achieve it.. at least up-until now.</em></p><hr><blockquote><h2 id=disclaimer-im-just-sharing-information-not-distrubuting-mod-files-here-this-is-strictly-for-learning-purposes-only>Disclaimer : Im just sharing information &amp; not distrubuting mod files here! this is strictly for learning purposes only.</h2></blockquote><h2 id=intro-why>Intro &amp; why:</h2><p>This post will be an another reverse engineering/modding post. I recommend checking out last three posts. <a href=https://bluepie.in/2019/07/android-reversing/ rel="nofollow noreferrer" target=_blank>&ldquo;Android Reversing&rdquo;</a>, <a href=https://bluepie.in/2019/10/android-reversing-part-2/ rel="nofollow noreferrer" target=_blank>&ldquo;Android Reversing Part 2&rdquo;</a> &amp; <a href=https://bluepie.in/2020/05/android-reversing-part-3/ rel="nofollow noreferrer" target=_blank>&ldquo;Android Reversing part 3&rdquo;</a></p><p>Today we will be looking at two apps to study on, to put it simply I did it for my friends, After I told them about the Terria experiment that I did in the last post, they asked me whether Advanced Download Manager &amp; Printer Sharer app can be modded too, I haven&rsquo;t felt this existed to work on something since a long time. I immediately started working on it. spoiler: I completed it quickly&hellip;but it was fun.</p><h3 id=apps-one-two>Apps one &amp; two:</h3><p>The first app is ADM (advanced download manager). this app has a premium activation, we will check whether we can exploit this feature.</p><p>The second app is Print share anywhere, this app has premium features that works by installing another app that has to be bought from google play store, for the app to work both applications should have to installed.</p><h2 id=new>New:</h2><p>Taking apart of &ldquo;app one&rdquo; and &ldquo;app two&rdquo; does not contain anything new, refer previous post for this section.</p><p>Before discussing the possible ways to achieve our goals, there is something we would like to know, usually when an app has premium features, during first launch the default state of the purchase flag in code will be &lsquo;not purchased&rsquo;(in code), what I mean by &ldquo;first launch&rdquo; is installing the app fresh from app store and launching it for the first time or it communicates with some license server for it information for the first time.</p><p>Second thing we should know about: we are getting into advanced territory here, I&rsquo;ve been sharing basic modding until now, lets go advanced for a change.</p><h2 id=accessing-data>Accessing data:</h2><p>As mentioned the debug flag &lsquo;android:debuggable=&ldquo;true&rdquo;&rsquo; must be added to manifest.xml.</p><p>as of writing this post, Google&rsquo;s last stable release is android 9 and the following methond works on my devices running android 8 &amp; 9.</p><p>make sure the device is connected and has debugging enabled.</p><pre><code class=language-shell>
&gt; adb shell

shell $ run-as package_name

</code></pre><h2 id=interesting-part>Interesting part:</h2><p>For an application to work, consider it being android, apple, windows, space-craft software&hellip;(i.e)any piece of software that has to run and has to retain memory between launches, It has to store the state someplace.</p><p>Yes exactly the android applications work on the same principle. how do we access it?
We can add the debug flag during compilation of the app and install it to the device and run it, by this we overcome the restriction imposed by the android system, (i.e) applications private data can not be accessed by us.</p><p>We can then investigate the configs, private files of the app, One common way an app retains information for example: Entering your name in the app, it remembers it by store the information inside these files(there could be other-ways but lets not over-complicate things).</p><p>Theoretically, after we find out where the config to app&rsquo;s purchase state is found, we can insert new code into the app to change the &lsquo;buy state&rsquo; of the application.</p><p>I later found out that these two apps were way-too-simple to mod, so did not bother use this, but anyway Keep this idea in the mind, we might use it in the future.</p><h2 id=patching>patching:</h2><p>Ways to overcome app one:</p><p>So after I decompiled the app, It was way too easy, they maintain a flag and use the flag everywhere for premium option, So basically I can just change it? Yea that is what I did and recompiled whola!. You have to be carefull here since during the first launch, It will just check with server whether you have bought the app from google app store or not. if we bought the app, then it stores the status in memory, what we could do here is change the smali-code to default go to insert the premium status in memory, doing <em>this way we could not worry about the different lifecycle problems that you might face. pause, destroy, resume states of the app.</em></p><p>Ways to overcome for app two:</p><p>The second app had the same logic, I made a similar patch in smali, the actual logic and smali code are as follows:</p><p>before:</p><pre><code class=language-java>    // by default the license variable contains false values,
    public static final Boolean[] is_prm = new Boolean[2];

</code></pre><p>after:</p><pre><code class=language-java>
    public static final Boolean[] is_prm = {true, true};

</code></pre><p>In smali, it translates to:</p><pre><code class=language-smali>
    const/4 v4, 0x1

    const/4 v0, 0x2

    new-array v0, v0, [Ljava/lang/Boolean;

    const/4 v2, 0x0

    invoke-static {v4}, Ljava/lang/Boolean;-&gt;valueOf(Z)Ljava/lang/Boolean;

    move-result-object v3

    aput-object v3, v0, v2

    invoke-static {v4}, Ljava/lang/Boolean;-&gt;valueOf(Z)Ljava/lang/Boolean;

    move-result-object v2

    aput-object v2, v0, v4

    .line 398
    sput-object v0, Lcom/dynamixsoftware/printershare/Billing;-&gt;is_prm:[Ljava/lang/Boolean;

</code></pre><blockquote><p>Apart from the first app utilising pro-guard, these two apps required very little work, but I enjoyed it neverthless.</p></blockquote><p>Im not gone share the apk for obvious reasons, this concludes this post, have a good day &amp; see you next time.</p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>Bluepie</span></p><p class=copyright-item><span>Link:</span>
<a href=//bluepie.in/2020/06/android-reversing-part-4/>//bluepie.in/2020/06/android-reversing-part-4/</span></p></div><div class=post-tags><section><a href=javascript:window.history.back();>back</a></span> Â·
<span><a href=//bluepie.in/>home</a></span></section></div><div class=post-nav><a href=//bluepie.in/2020/05/android-reversing-part-3/ class=prev rel=prev title="Android Reversing Part 3"><i class="iconfont icon-left"></i>&nbsp;Android Reversing Part 3</a>
<a href=//bluepie.in/2020/07/rinku/ class=next rel=next title=Rinku>Rinku&nbsp;<i class="iconfont icon-right"></i></a></div><div class=post-comment><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"gopinath001-github-io-blog"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2017 - 2021</span>
<span class=with-love>|</span>
<span class=author itemprop=copyrightHolder><a href=//bluepie.in/>Bluepie</a></span></div></footer><script src=//bluepie.in/js/vendor_no_gallery.min.js async></script></div></body></html>